flowchart TB
    subgraph PRESENTATION["ğŸ–¥ï¸ Presentation Layer - Pages (14)"]
        direction LR
        AI_CHAT[ğŸ’¬ AI Chat<br/>Ollama]
        OPENAI_CHAT[ğŸ¤– OpenAI Chat<br/>GPT]
        LYRIC_CREATION[âœï¸ Lyric Creation<br/>Editor]
        LYRIC_RULES[ğŸ“œ Lyric Rules<br/>Regex Cleanup]
        MUSIC_STYLES[ğŸ¼ Music Styles<br/>Templates]
        IMG_GEN[ğŸ–¼ï¸ Image Generator<br/>DALL-E]
        IMG_VIEW[ğŸ‘ï¸ Image View<br/>Gallery]
        SONG_GEN[ğŸµ Song Generator<br/>Mureka]
        SONG_VIEW[ğŸ§ Song View<br/>Library]
        SONG_PROFILE[ğŸ“Š Song Profile<br/>Mureka Account]
        SKETCH_CREATOR[ğŸ“ Sketch Creator<br/>Draft Songs]
        SKETCH_LIBRARY[ğŸ“š Sketch Library<br/>Manage Drafts]
        USER_PROFILE[ğŸ‘¤ User Profile<br/>Settings]
        PROMPT_TEMPLATES[ğŸ“‹ Prompt Templates<br/>Reusable Prompts]
    end

    subgraph COMPONENT["ğŸ§© Component Layer - Shared Components"]
        direction LR
        SIDE_MENU[ğŸ” Side Menu]
        IMAGE_DETAIL[ğŸ–¼ï¸ Image Detail Panel]
        SONG_DETAIL[ğŸµ Song Detail Panel]
        LYRIC_ARCHITECT[ğŸ—ï¸ Lyric Architect Modal]
        MUSIC_CHOOSER_MODAL[ğŸ¼ Music Style Chooser Modal]
        MUSIC_CHOOSER_INLINE[ğŸ¶ Music Style Chooser Inline]
        SEARCH_REPLACE[ğŸ” Search Replace Dialog]
        PASSWORD_MODAL[ğŸ” Password Change Modal]
        AUDIO_PLAYER[ğŸµ Audio Player]
        PROGRESS[â³ Progress Overlay]
    end

    subgraph SERVICE["âš™ï¸ Service Layer"]
        direction LR
        subgraph BUSINESS["Business Services"]
            IMG_SVC[ğŸ–¼ï¸ Image Service]
            SONG_SVC[ğŸµ Song Service]
            SKETCH_SVC[ğŸ“ Sketch Service]
            CONV_SVC[ğŸ’¬ Conversation Service]
            AUTH_SVC[ğŸ” Auth Service]
            USER_SVC[ğŸ‘¤ User Service]
            CHAT_EXPORT[ğŸ“¤ Chat Export]
            OPENAI_SVC[ğŸ¤– OpenAI Chat Service]
        end
        subgraph CONFIG["Configuration"]
            API_CONFIG[ğŸŒ API Config Service]
            CHAT_SVC[ğŸ’¬ Chat Service]
        end
        subgraph UI_SERVICES["UI Services"]
            LYRIC_ARCH_SVC[ğŸ—ï¸ Lyric Architecture Service]
            PROGRESS_SVC[â³ Progress Service]
            NOTIFY_SVC[ğŸ”” Notification Service]
        end
    end

    subgraph INFRASTRUCTURE["ğŸ› ï¸ Infrastructure Layer"]
        direction LR
        MODELS[ğŸ“Š Models]
        PIPES[ğŸ”„ Pipes<br/>message-content.pipe]
        GUARDS[ğŸ›¡ï¸ Guards<br/>Auth]
        INTERCEPTORS[ğŸ”— Interceptors<br/>JWT Injection]
        AUTH[ğŸ” Auth Components<br/>Login]
    end

    subgraph EXTERNAL["ğŸŒ External Systems"]
        direction LR
        BACKEND[ğŸ–¥ï¸ aiproxysrv API<br/>FastAPI]
        OLLAMA[ğŸ¦™ Ollama<br/>Local LLM]
        OPENAI_API[ğŸ¤– OpenAI API<br/>DALL-E & GPT]
        MUREKA_API[ğŸµ Mureka API<br/>Music Generation]
    end

    %% Layer Dependencies
    PRESENTATION --> COMPONENT
    COMPONENT --> SERVICE
    SERVICE --> INFRASTRUCTURE
    SERVICE --> EXTERNAL

    %% Styling
    classDef presentationStyle fill:#E8F5E8,stroke:#4CAF50,stroke-width:2px
    classDef componentStyle fill:#E3F2FD,stroke:#2196F3,stroke-width:2px
    classDef serviceStyle fill:#FFF3E0,stroke:#FF9800,stroke-width:2px
    classDef infrastructureStyle fill:#FCE4EC,stroke:#E91E63,stroke-width:2px
    classDef externalStyle fill:#F3E5F5,stroke:#9C27B0,stroke-width:2px

    class AI_CHAT,OPENAI_CHAT,LYRIC_CREATION,LYRIC_RULES,MUSIC_STYLES,IMG_GEN,IMG_VIEW,SONG_GEN,SONG_VIEW,SONG_PROFILE,SKETCH_CREATOR,SKETCH_LIBRARY,USER_PROFILE,PROMPT_TEMPLATES presentationStyle
    class SIDE_MENU,IMAGE_DETAIL,SONG_DETAIL,LYRIC_ARCHITECT,MUSIC_CHOOSER_MODAL,MUSIC_CHOOSER_INLINE,SEARCH_REPLACE,PASSWORD_MODAL,AUDIO_PLAYER,PROGRESS componentStyle
    class IMG_SVC,SONG_SVC,SKETCH_SVC,CONV_SVC,AUTH_SVC,USER_SVC,CHAT_EXPORT,OPENAI_SVC,API_CONFIG,CHAT_SVC,LYRIC_ARCH_SVC,PROGRESS_SVC,NOTIFY_SVC serviceStyle
    class MODELS,PIPES,GUARDS,INTERCEPTORS,AUTH infrastructureStyle
    class BACKEND,OLLAMA,OPENAI_API,MUREKA_API externalStyle
