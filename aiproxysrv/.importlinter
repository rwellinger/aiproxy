[importlinter]
root_package = src
include_external_packages = True

# ============================================================================
# Three-Layer Architecture Validation
# ============================================================================
# Enforces separation between:
# - Controllers (api.controllers) - HTTP layer
# - Business Logic (business) - Orchestrators, Transformers, Normalizers
# - Data Access (db) - Repositories/CRUD services
# ============================================================================

[importlinter:contract:controllers-no-direct-db]
name = Controllers must go through business layer, not directly to DB
type = forbidden
source_modules =
    src.api.controllers
forbidden_modules =
    src.db

[importlinter:contract:db-no-business]
name = DB layer must not import business logic
type = forbidden
source_modules =
    src.db
forbidden_modules =
    src.business

[importlinter:contract:business-pure-functions]
name = Business logic must be pure (no direct SQLAlchemy imports)
type = forbidden
source_modules =
    src.business
forbidden_modules =
    sqlalchemy

[importlinter:contract:business-no-controllers]
name = Business layer must not import controllers
type = forbidden
source_modules =
    src.business
forbidden_modules =
    src.api.controllers

# ============================================================================
# Additional Architectural Rules
# ============================================================================

[importlinter:contract:schemas-no-business]
name = Schemas must not depend on business logic
type = forbidden
source_modules =
    src.schemas
forbidden_modules =
    src.business
    src.db
